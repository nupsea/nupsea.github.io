---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

function formatDate(date: Date) {
  return new Date(date).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  });
}
---

<Layout>
	<div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
		<header class="mb-16">
			<h1 class="text-4xl font-bold text-slate-900 sm:text-5xl mb-4">Blog</h1>
			<p class="text-xl text-slate-600">Thoughts on Data Engineering, Reliability, and AI.</p>
		</header>

		<div class="grid gap-12 lg:grid-cols-2">
			{posts.map((post) => (
				<article class="flex flex-col items-start justify-between bg-white border border-slate-200 rounded-2xl p-8 hover:shadow-md transition-shadow">
					<div class="flex items-center gap-x-4 text-xs">
						<time datetime={post.data.pubDate.toISOString()} class="text-slate-500">
							{formatDate(post.data.pubDate)}
						</time>
					</div>
					<div class="group relative">
						<h3 class="mt-3 text-lg font-semibold leading-6 text-slate-900 group-hover:text-blue-600">
							<a href={`/blog/${post.slug}/`}>
								<span class="absolute inset-0"></span>
								{post.data.title}
							</a>
						</h3>
						<p class="mt-5 line-clamp-3 text-sm leading-6 text-slate-600">
							{post.data.description}
						</p>
					</div>
				</article>
			))}
		</div>
	</div>
</Layout>
